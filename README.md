# StreamVoice - GPT-SoVITS 语音合成客户端

StreamVoice 是一个基于 SwiftUI 开发的 macOS 应用程序，为 GPT-SoVITS 语音合成引擎提供了一个直观的图形界面。该应用支持实时语音合成和流式音频输出，让用户能够方便地进行语音克隆和合成。

## 功能特点

### 核心功能
- 支持选择参考音频文件进行语音克隆
- 支持输入参考音频对应的文本内容
- 支持自定义要合成的目标文本
- 实时语音合成和播放
- 支持流式输出模式，实现更快的响应速度

### 高级设置
- **文本切分设置**
  - 多种文本切分方法（不切分/四句一切/50字一切/按句号切等）
  - 可调节批处理大小(1-200)
  - 可调节批处理阈值(0.1-1.0)
  - 支持分桶处理
  
- **推理参数设置**
  - Top-K 采样 (1-100)
  - Top-P 采样 (0.01-1.0)
  - 温度系数 (0.01-1.0)
  - 重复惩罚 (0.0-2.0)
  - 并行推理开关
  - 语速调节 (0.01-2.0)
  - 片段间隔设置 (0.01-1.0)

### 技术特性
- 支持 WAV 格式音频处理
- 自动解析音频格式参数（采样率、通道数、位深度）
- 实现音频流式播放
- 错误重试机制
- 本地缓存管理

## 系统要求
- macOS 11.0 或更高版本
- 需要本地运行 GPT-SoVITS 服务（默认端口：9880）

## 使用说明

1. **启动服务**
   - 确保已在本地启动 GPT-SoVITS 服务
   - 默认服务地址为 `http://127.0.0.1:9880`

2. **基本操作流程**
   - 点击"选择参考音频"按钮选择要克隆的声音样本
   - 在参考音频文本框中输入音频对应的文本内容
   - 在合成文本框中输入要转换的目标文本
   - 点击"播放"按钮开始合成和播放
   - 可随时点击"停止"按钮终止播放

3. **高级设置**
   - 点击"高级设置"展开更多参数选项
   - 根据需要调整文本切分和推理参数
   - 建议新用户保持默认设置，熟悉后再进行调整

4. **流式输出**
   - 开启流式输出可实现更快的响应速度
   - 适合处理较长文本的情况
   - 可能会有轻微的延迟

## 错误处理
- 如遇到合成失败，请检查：
  - GPT-SoVITS 服务是否正常运行
  - 参考音频格式是否正确
  - 参数设置是否在有效范围内
- 可以尝试点击"清除缓存"按钮重置应用状态

## 注意事项
- 确保参考音频质量良好，避免背景噪音
- 参考文本应与音频内容准确对应
- 较长文本建议开启流式输出模式
- 调整参数时建议小幅度改动，观察效果
- 如遇性能问题，可适当降低批处理大小

## 技术支持
如果遇到问题，请检查：
1. 本地服务是否正常运行（默认端口9880）
2. 参考音频文件是否可访问
3. 参数设置是否在合理范围内
4. 系统音频设置是否正常

## 开发说明
本项目使用 SwiftUI 框架开发，主要包含以下核心文件：
- `GPTSovits.swift`: 核心功能实现，包括语音合成和音频处理
- `ContentView.swift`: 用户界面实现，包括参数设置和交互逻辑

// ... existing code ...

## 开发说明
本项目使用 SwiftUI 框架开发，主要包含以下核心文件：
- `GPTSovits.swift`: 核心功能实现，包括语音合成和音频处理
- `ContentView.swift`: 用户界面实现，包括参数设置和交互逻辑

## 运行说明

### 启动 GPT-SoVITS 服务
1. 在 GPT-SoVITS 项目目录中找到 `go-api.command` 文件
2. 双击运行该文件，它会：
   - 检查并安装必要的 ffmpeg
   - 激活 Python 运行环境
   - 启动 v2 版本的 API 服务

`go-api.command` 文件内容：
```
#!/bin/bash

# 检查 ffmpeg 是否已安装
if command -v ffmpeg >/dev/null 2>&1; then
    echo "ffmpeg 已安装."
else
    echo "ffmpeg 未安装."
    echo "安装 ffmpeg..."
    brew install ffmpeg  
fi

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" &>/dev/null && pwd)"

cd "$SCRIPT_DIR"

source "./runtime/bin/activate"

echo "乐"

"./runtime/bin/python3" api_v2.py
```

欢迎贡献代码或提出改进建议！
